<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>{{ movie.title }} - FORMAT Filmkunst-Verleih</title>
    <!-- Responsive Meta Tag -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Fonts and Stylesheets -->
    <link href="https://fonts.googleapis.com/css2?family=Cardo:ital@0;1&family=Lato:wght@300;400;700&family=Pinyon+Script&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/pages/movie_details.css') }}">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
    <!-- Swiper.js CSS for Carousel -->
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <!-- Tippy.js CSS -->
    <link rel="stylesheet" href="https://unpkg.com/tippy.js@6/dist/tippy.css" />
    <!-- Popper.js (required by Tippy.js) -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <!-- Tippy.js JS -->
    <script src="https://unpkg.com/tippy.js@6"></script>
</head>
<body data-folder="{{ movie.folder_name }}">

    <!-- Theme Application Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const theme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', theme);
        });
    </script>

<div class="page-container">
    <header>
        <nav class="navbar">
            <div class="logo">
                <a href="{{ url_for('index') }}"><span>FORMAT</span></a>
                <a href="{{ url_for('catalog') }}" class="sub-logo"><span>Katalog</span></a>
            </div>
            <div class="nav-center-title">
                <span class="theme-title">{{ movie.format_titel }}</span>
            </div>
        </nav>
    </header>
    <main>
        <!-- Movie Details Section -->
        <section class="movie-details">
            <!-- Backdrop Carousel -->
            {% if movie.backdrops %}
            <div class="backdrop-carousel">
                <!-- Swiper Carousel Wrapper -->
                <div class="swiper-wrapper-container">
                    <div class="swiper-container">
                        <div class="swiper-wrapper">
                            {% for backdrop in movie.backdrops %}
                            <div class="swiper-slide">
                                <img src="{{ backdrop }}" alt="Backdrop Image for {{ movie.format_titel }}" loading="lazy">
                            </div>
                            {% endfor %}
                        </div>
                        <!-- Add Pagination -->
                        <div class="swiper-pagination"></div>
                        <!-- Add Navigation -->
                        <button class="swiper-button-prev" aria-label="Previous Slide"><i class="fas fa-chevron-left"></i></button>
                        <button class="swiper-button-next" aria-label="Next Slide"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>
            {% else %}
            <!-- Fallback if no backdrops or posters are available -->
            <div class="backdrop-placeholder">
                {% if movie.posters %}
                <!-- Use the first poster as the backdrop -->
                <img src="{{ movie.posters[0] }}" alt="Poster Image as Backdrop for {{ movie.format_titel }}" loading="lazy">
                {% else %}
                <img src="{{ url_for('static', filename='images/default_backdrop.jpg') }}" alt="No Backdrop Available" loading="lazy">
                {% endif %}
            </div>
            {% endif %}

            <!-- Poster and Content Container -->
            <div class="poster-content-container">
                <!-- Poster Image -->
                {% if movie.posters %}
                <div class="wrap-poster">
                    <img src="{{ movie.posters[0] }}" alt="Poster Image for {{ movie.format_titel }}" loading="lazy">
                    {% if movie.video_link %}
                    <a href="{{ movie.video_link }}" class="play-trailer-overlay" target="_blank" aria-label="Play Trailer for {{ movie.format_titel }}">
                        <i class="fas fa-play"></i>
                    </a>
                    {% endif %}
                </div>
                {% endif %}

                <!-- Additional Information -->
                <div class="content-wrap">
                    <h1 class="movie-title">{{ movie.format_titel }} <span class="release-year">({{ movie.release_date }})</span></h1>
                    <h2 class="original-title">Originaltitel: <em>{{ movie.original_title }}</em></h2>

                    <div class="movie-info">
                        <!-- Info Items -->
                        {% if movie.directors %}
                        <div class="info-item">
                            <i class="fas fa-video"></i>
                            <span class="director">
                                {% for director in movie.directors %}
                                    <span class="person-tooltip" data-tmdb-id="{{ director.tmdb_id }}" data-person-name="{{ director.name }}">
                                        {{ director.name }}
                                    </span>
                                    <a href="#" class="filter-icon" data-person-name="{{ director.name }}" title="Filter by {{ director.name }}"><i class="fas fa-filter"></i></a>
                                    {% if not loop.last %}, {% endif %}
                                {% endfor %}
                            </span>
                        </div>
                        {% endif %}
                        <div class="info-item">
                            <i class="fas fa-clock"></i>
                            <span class="info-text">{{ movie.runtime }} Minuten</span>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-star"></i>
                            <span class="info-text">
                                <a href="https://www.imdb.com/title/tt{{ movie.imdb_id }}" target="_blank">{{ movie.imdb_rating }}</a>
                            </span>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-tags"></i>
                            <span class="info-text">
                                {% for genre in movie.genres %}
                                    <a href="#" class="genre-filter" data-genre="{{ genre }}">{{ genre }}</a>{% if not loop.last %}, {% endif %}
                                {% endfor %}
                            </span>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-globe"></i>
                            <span class="info-text">
                                {% for country in movie.countries %}
                                    <a href="#" class="country-filter" data-country="{{ country }}">{{ country }}</a>{% if not loop.last %}, {% endif %}
                                {% endfor %}
                            </span>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-building"></i>
                            <span class="info-text">
                                {{ movie.production_companies | join(', ') }}
                            </span>
                        </div>
                        <!-- Awards -->
                        {% if movie.awards %}
                        <div class="info-item">
                            <i class="fas fa-trophy"></i>
                            <span class="info-text">
                                {{ movie.awards | join(', ') }}
                            </span>
                        </div>
                        {% endif %}

                        <!-- Spoken Languages -->
                        {% if movie.spoken_languages %}
                        <div class="info-item">
                            <i class="fas fa-language"></i>
                            <span class="info-text">
                                {{ movie.spoken_languages | join(', ') }}
                            </span>
                        </div>
                        {% endif %}
                        <!-- Formats -->
                        {% if movie.formats %}
                        <div class="info-item">
                            <i class="fas fa-film"></i>
                            <span class="info-text">
                                {{ movie.formats }}
                            </span>
                        </div>
                        {% endif %}
                    </div>

                    <!-- Additional Movie Information -->
                    <div class="additional-info">
                        {% if movie.overview %}
                            <p class="overview">
                                {{ movie.overview }}
                            </p>
                        {% endif %}

                        {% if movie.actors %}
                            <p class="actors">
                                <strong>Schauspieler:</strong>
                                {% for actor in movie.actors %}
                                    <span class="person-tooltip" data-tmdb-id="{{ actor.tmdb_id }}" data-person-name="{{ actor.name }}">
                                        {{ actor.name }}
                                    </span>

                                    <a href="https://www.themoviedb.org/person/{{ actor.tmdb_id }}" target="_blank" class="filter-icon" data-person-name="{{ actor.name }}" title="Filter by {{ actor.name }}">
                                        <i class="fas fa-filter"></i>
                                    </a>
                                    
                                    {% if not loop.last %}, {% endif %}
                                {% endfor %}
                            </p>
                        {% endif %}

                        {% if movie.wiki_critics %}
                            <p class="wiki-critics">
                                <strong>Kritiken:</strong>
                                {{ movie.wiki_critics }}
                            </p>
                        {% endif %}
                        {% if movie.wiki_background %}
                            <p class="wiki-background">
                                <strong>Hintergrund:</strong>
                                {{ movie.wiki_background }}
                            </p>
                        {% endif %}
                    </div>
                </div> <!-- End of content-wrap -->
            </div> <!-- End of poster-content-container -->

        </section>
    </main>
    <footer>
        <div class="footer-content">
            <p>&copy; 2024 FORMAT Filmkunst-Verleih e.V. Alle Rechte vorbehalten.</p>
        </div>
    </footer>
</div>

<!-- Swiper.js JS for Carousel -->
<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
<script src="{{ url_for('static', filename='js/navbar.js') }}"></script>
<!-- Scripts -->
<script src="{{ url_for('static', filename='js/movie_details.js') }}"></script>

</body>
</html>
